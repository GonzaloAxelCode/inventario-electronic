<!-- ================= MOBILE ================= -->
<div class="space-y-3 sm:hidden">

  <div *ngFor="let venta of ventas"
       class="bg-white dark:bg-neutral-800
              border border-neutral-200 dark:border-neutral-700
              rounded-2xl p-4 shadow-sm">

    <!-- CABECERA -->
    <div class="flex justify-between items-start relative">
       <div *ngIf="venta.comprobante_nota_credito" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/3
       opacity-20 pointer-events-none z-10">
              <img
                src="https://png.pngtree.com/png-vector/20221210/ourmid/pngtree-canceled-canceled-annulled-red-vector-png-image_15495002.png"
                alt="">
            </div>
      <div>
        <p class="text-base font-extrabold">
          <ng-container *ngIf="venta.comprobante">
            {{ venta.comprobante.serie }}-{{ venta.comprobante.correlativo }}
          </ng-container>
          <ng-container *ngIf="!venta.comprobante">
            Venta #{{ venta.id }}
          </ng-container>
        </p>

        <p class="text-xs text-neutral-500">
          {{ formatoCorto(venta.fecha_hora) }} · {{ formatoHora12(venta.fecha_hora) }}
        </p>
      </div>

      <tui-badge
        size="s"
        [appearance]="venta.comprobante.estado_sunat === 'RECHAZADO' ? 'error' :
          venta.comprobante.estado_sunat === 'ACEPTADO' ? 'positive' :
          venta.comprobante.estado_sunat === 'PENDIENTE' ? 'warning' : 'neutral'">
        {{ venta.comprobante.estado_sunat }}
      </tui-badge>
    </div>

    <!-- PRODUCTOS MOBILE -->
    <div class="mt-3 space-y-2">
      <div *ngFor="let item of venta.productos"
           class="flex items-center gap-3 text-sm">

        <img
          [src]="item.producto_imagen
            ? URL_BASE + item.producto_imagen
            : 'https://sublimac.com/wp-content/uploads/2017/11/default-placeholder.png'"
          class="w-10 h-10 rounded-lg object-cover border" />

        <div class="flex-1 min-w-0">
          <p class="font-medium truncate">
            {{ item.producto_nombre }}
          </p>
          <p class="text-xs text-neutral-500">
            x{{ item.cantidad }}
          </p>
        </div>

        <span class="font-semibold whitespace-nowrap">
          S/ {{ getValorVentaRedondeado((item?.valor_venta || 0) + (item?.igv || 0)) }}
        </span>
      </div>
    </div>

    <!-- FOOTER -->
    <div class="mt-4 flex justify-between items-center">
      <span class="text-lg font-extrabold">
        Total: S/. {{ venta.total }}
      </span>

      <button
        tuiButton
        size="s"
        appearance="primary-grayscale"
        (click)="showDialogVentaDetail(venta)">
        Detalles
      </button>
    </div>

  </div>
</div>



<!-- ================= DESKTOP ================= -->
<div class="hidden sm:block space-y-4">

  <div *ngFor="let venta of ventas"
       class="bg-white dark:bg-neutral-800 overflow-hidden
              border border-neutral-200 dark:border-neutral-700
              rounded-2xl p-5 hover:shadow-md transition">

    <!-- HEADER -->
    <div class="flex justify-between items-center relative">
  <div *ngIf="venta.comprobante_nota_credito" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/3
       opacity-20 pointer-events-none z-10">
              <img
                src="https://png.pngtree.com/png-vector/20221210/ourmid/pngtree-canceled-canceled-annulled-red-vector-png-image_15495002.png"
                alt="">
            </div>
      <div>
        <p class="text-lg font-extrabold">
          {{ venta.comprobante?.serie }}-{{ venta.comprobante?.correlativo }}
        </p>
        <p class="text-xs text-neutral-500">
          {{ formatoCorto(venta.fecha_hora) }} · {{ formatoHora12(venta.fecha_hora) }}
        </p>
      </div>

      <div class="flex items-center gap-4">
        <tui-badge
          size="m"
          [appearance]="venta.comprobante.estado_sunat === 'RECHAZADO' ? 'error' :
            venta.comprobante.estado_sunat === 'ACEPTADO' ? 'positive' :
            venta.comprobante.estado_sunat === 'PENDIENTE' ? 'warning' : 'neutral'">
          {{ venta.comprobante.estado_sunat }}
        </tui-badge>

        <span class="text-xl font-extrabold">
          S/. {{ venta.total }}
        </span>

        <button
          tuiButton
          size="s"
          appearance="primary-grayscale"
          (click)="showDialogVentaDetail(venta)">
          Detalles
        </button>
      </div>
    </div>

    <!-- PRODUCTOS DESKTOP -->
    <div class="mt-4 divide-y dark:divide-neutral-700">

      <div *ngFor="let item of venta.productos"
           class="flex items-center gap-4 py-3">

        <img
          [src]="item.producto_imagen
            ? URL_BASE + item.producto_imagen
            : 'https://sublimac.com/wp-content/uploads/2017/11/default-placeholder.png'"
          class="w-12 h-12 rounded-lg object-cover border" />

        <p class="flex-1 font-medium">
          {{ item.producto_nombre }}
        </p>

        <span class="text-sm">
          x{{ item.cantidad }}
        </span>

        <span class="font-bold">
          S/ {{ getValorVentaRedondeado((item?.valor_venta || 0) + (item?.igv || 0)) }}
        </span>
      </div>

    </div>

  </div>
</div>
