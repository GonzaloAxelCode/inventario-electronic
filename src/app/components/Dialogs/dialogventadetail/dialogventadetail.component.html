<div    *ngIf="venta.estado !== 'Pendiente' && venta.tipo_comprobante !== 'Sin Comprobante'"  class="flex flex-col md:flex-row gap-6 ">


  <div class="flex-1 bg-transparent  rounded-2xl overflow-hidden">
    <!-- Encabezado -->
    <div class="p-2 border-b border-gray-200 dark:border-gray-700 flex flex-col md:flex-row justify-between items-start md:items-center">
      <div class="flex items-center gap-4  md:mb-0">
         <a routerLink="/"
  class="flex items-center gap-3  text-xl font-bold transition-all duration-300 ease-in-out text-white">
  <span>
    <img src="https://res.cloudinary.com/ddksrkond/image/upload/c_crop,w_350,h_150/v1755473642/APP%20INVENTARIO/T-removebg-preview_zgnu7f.png"
         class=" transition-all duration-300 invert-0 dark:invert w-44"  
         alt="">
  </span>
</a>
      </div>
      <div class="text-right">
        
        <p class="text-gray-800 text-2xl font-bold dark:text-gray-400">{{ comprobante.tipo_comprobante | uppercase }} #{{ comprobante.correlativo }}</p>
        <p class="text-gray-600 dark:text-gray-400">Fecha: {{ venta.fecha_realizacion || venta.fecha_hora | date:'mediumDate' }}</p>

        <p *ngIf="venta.estado === 'ANULADA'" class="text-red-600 text-2xl font-bold ">ANULADO EN SUNAT</p>
       </div>
    </div>

    <!-- Cliente / Detalles de Factura / Proveedor / Responsable -->
    <div class="p-2  border-b border-gray-200 dark:border-gray-700 grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <p class="font-medium mb-2 text-gray-700 dark:text-gray-200">Datos de cliente:</p>
        <p class=" text-sm text-gray-600 dark:text-gray-300"> {{ comprobante.nombre_cliente || 'Cliente Ejemplo' }}</p>
        <p class=" text-sm text-gray-600 dark:text-gray-300"> {{ comprobante.numero_documento_cliente || '12345678' }}</p>
        
        
      </div>
      <div>
        <p class="font-medium mb-2 text-gray-700 dark:text-gray-200">Detalles de Factura:</p>
        <table class="w-full text-sm text-gray-600 dark:text-gray-300">
          <tbody>
            <tr>
              <td class="pr-4">Total:</td>
              <td class="font-medium text-right">S/{{ getValorVentaRedondeado(comprobante.total) }}</td>
            </tr>
            <tr>
              <td class="pr-4">Subtotal:</td>
              <td class="text-right">S/{{ getValorVentaRedondeado(comprobante.sub_total) }}</td>
            </tr>
            <tr>
              <td class="pr-4">IGV:</td>
              <td class="text-right">S/{{ getValorVentaRedondeado(comprobante.igv) }}</td>
            </tr>
        
            <tr>
              <td class="pr-4">Responsable:</td>
              <td class="text-right">{{ venta.usuario || 'Admin' }}</td>
            </tr>
          
                        <tr>
              <td class="pr-4">Estado:</td>
              <td class="text-right">{{ venta.estado || 'Pendiente' }}</td>
            </tr>
            <tr>
              <td class="pr-4">Método de Pago:</td>
              <td class="text-right">{{ venta.metodo_pago || 'Efectivo' }}</td>
            </tr>

          </tbody>
        </table>
      </div>
    </div>

    <!-- Tabla de Items -->
    <div class="overflow-x-auto p-6">
      <table class="w-full text-sm border border-gray-200 dark:border-gray-700 rounded-lg">
        <thead class="bg-gray-50 dark:bg-neutral-700">
          <tr>
            <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-200">Artículo</th>
            <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-200">Descripción</th>
            <th class="px-4 py-2 text-right text-gray-700 dark:text-gray-200">Costo Unitario</th>
            <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-200">Cantidad</th>
            <th class="px-4 py-2 text-right text-gray-700 dark:text-gray-200">Total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of comprobante.items" class="hover:bg-gray-100 dark:hover:bg-gray-700">
            <td class="px-4 py-2 font-medium text-gray-800 dark:text-gray-200">{{ item.codigo }}</td>
            <td class="px-4 py-2 text-gray-600 dark:text-gray-300">{{ item.descripcion }}</td>
            <td class="px-4 py-2 text-right text-gray-600 dark:text-gray-300">{{ getValorVentaRedondeado(item.valorUnitario) }}</td>
            <td class="px-4 py-2 text-center text-gray-600 dark:text-gray-300">{{ item.cantidad }}</td>
            <td class="px-4 py-2 text-right text-gray-600 dark:text-gray-300">{{ getValorVentaRedondeado(item.valorVenta) }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Totales -->
    <div class="p-2 flex flex-col md:flex-row justify-end gap-6 text-gray-800 dark:text-gray-200">
      <div class="text-right space-y-1">
        <p>Subtotal: S/{{ getValorVentaRedondeado(comprobante.sub_total) }}</p>
        <p>IGV: S/{{ getValorVentaRedondeado(comprobante.igv) }}</p>
        <p class="font-bold text-lg border-t border-gray-300 dark:border-gray-600 pt-1">Total: S/{{ getValorVentaRedondeado(comprobante.total) }}</p>
      </div>
    </div>


  </div>


  <div  class="w-full md:w-72 flex-shrink-0 flex flex-col gap-4">
    
      <h3 class="text-black dark:text-white">Operaciones comprobante </h3>
        <!-- Botones -->
        <div *ngIf="venta.estado !== 'ANULADA'" class="flex flex-row gap-4 flex-wrap">
            <a [href]="comprobante.pdf_url" target="_blank" iconStart="@tui.file-chart-column-increasing"
                tuiButtonVertical tuiButton appearance="positive"
                class="bg-blue-600  text-white rounded-lg shadow transition">
                Ver PDF
            </a>

            <a [href]="comprobante.xml_url" target="_blank" iconStart="@tui.file-code-2"
                tuiButton appearance="warning"
                class="bg-gray-600  text-white rounded-lg shadow transition" tuiButtonVertical>
                Ver XML
            </a>

            <a iconStart="@tui.folder-archive" [href]="comprobante.cdr_url" target="_blank"
                tuiButton appearance="info"
                tuiButtonVertical
                class="bg-yellow-600  text-white rounded-lg shadow transition">
                Ver CDR
            </a>

            <a iconStart="@tui.ticket-check" [href]="comprobante.ticket_url" target="_blank"
                tuiButton 
                tuiButtonVertical
                class="bg-green-600  text-white rounded-lg shadow transition">
                Ver Ticket
            </a>
   <button   tuiButton appearance="floating" iconStart="@tui.send-horizontal"
                tuiButtonVertical
                class=" text-white rounded-lg shadow transition">
               Enviar por correo
            </button>
            <button  tuiButton appearance="negative" 
            
            iconStart="@tui.ban"
                tuiButtonVertical (click)="anularVenta(venta.id)"
                [disabled]="loadingAnularVenta"
                
                class="bg-red-600  text-white rounded-lg shadow transition">
              <tui-loader *ngIf="loadingAnularVenta" size="m"></tui-loader>
                Anular Venta por nota de credito
              </button>
        </div>


          <div *ngIf="venta.estado === 'ANULADA'" class="flex flex-row gap-4 flex-wrap">
            <a [href]="venta.comprobante_nota_credito.pdf_url" target="_blank" iconStart="@tui.file-chart-column-increasing"
                tuiButtonVertical tuiButton appearance="positive"
                class="bg-blue-600  text-white  w-full rounded-lg shadow transition">
                Ver PDF Nota de credito
            </a>

            <a [href]="venta.comprobante_nota_credito.xml_url" target="_blank" iconStart="@tui.file-code-2"
                tuiButton appearance="warning" 
                class="bg-gray-600  text-white   w-full rounded-lg shadow transition" tuiButtonVertical>
                Ver XML Nota de credito
            </a>

            <a iconStart="@tui.folder-archive" [href]="venta.comprobante_nota_credito.cdr_url" target="_blank"
                tuiButton appearance="info"
                tuiButtonVertical
                class="bg-yellow-600  w-full text-white rounded-lg shadow transition">
                Ver CDR Nota de Credito
            </a>

            
   <button   tuiButton appearance="floating" iconStart="@tui.send-horizontal"
                tuiButtonVertical
                class=" text-white w-full rounded-lg shadow transition">
               Enviar por correo 
            </button>
           
        </div>
  </div>

</div>





<div *ngIf="venta.estado == 'Pendiente'" class="flex flex-col md:flex-row gap-6 p-4 md:p-6 ">

  <!-- Factura / Venta -->
  <div class="flex-1 bg-transparent rounded-2xl overflow-hidden">
    <!-- Encabezado -->
    <div class="p-2 border-b border-gray-200 dark:border-gray-700 flex flex-col md:flex-row justify-between items-start md:items-center">
      <div class="flex items-center gap-4 ">
        <a routerLink="/" class="flex items-center gap-3  text-xl font-bold transition-all duration-300 ease-in-out text-white">
          <img src="https://res.cloudinary.com/ddksrkond/image/upload/c_crop,w_350,h_150/v1755473642/APP%20INVENTARIO/T-removebg-preview_zgnu7f.png"
               class="transition-all duration-300 invert-0 dark:invert w-44" alt="Logo">
        </a>
      </div>
      <div class="text-right">
        <p class="text-gray-800 text-2xl font-bold dark:text-gray-400">VENTA #{{ venta.id }}</p>
        <p class="text-gray-600 dark:text-gray-400">Fecha: {{ venta.fecha_realizacion || venta.fecha_hora | date:'mediumDate' }}</p>
         </div>
    </div>

    <!-- Cliente / Proveedor / Responsable -->
    <div class="p-2 border-b border-gray-200 dark:border-gray-700 grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <p class="font-medium mb-2 text-gray-700 dark:text-gray-200">Detalles del cliente:</p>
        <p class="text-sm text-gray-600 dark:text-gray-300">Cliente :{{ venta.usuario }}</p>
        <p class="text-sm text-gray-600 dark:text-gray-300">Documento: {{'12345678' }}</p>
        <p class="text-sm text-gray-600 dark:text-gray-300">Dirección: {{ 'Calle Inventada 123, Ciudad' }}</p>
        <p class="text-sm text-gray-600 dark:text-gray-300">Teléfono: {{ '+51 999 888 777' }}</p>
      </div>
      <div>
        <p class="font-medium mb-2 text-gray-700 dark:text-gray-200">Detalles de Venta:</p>
        <table class="w-full text-sm text-gray-600 dark:text-gray-300">
          <tbody>
            <tr>
              <td class="pr-4">Proveedor:</td>
              <td class="text-right">{{  'Proveedor Ejemplo' }}</td>
            </tr>
            <tr>
              <td class="pr-4">Responsable:</td>
              <td class="text-right">{{ venta.usuario || 'Admin' }}</td>
            </tr>
            <tr>
              <td class="pr-4">Notas:</td>
              <td class="text-right">{{ '-' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Tabla de Productos -->
    <div class="overflow-x-auto p-6">
      <table class="w-full text-sm border border-gray-200 dark:border-gray-700 rounded-lg">
        <thead class="bg-gray-50 dark:bg-neutral-700">
          <tr>
            <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-200">Artículo</th>
            <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-200">Descripción</th>
            <th class="px-4 py-2 text-right text-gray-700 dark:text-gray-200">Costo Unitario</th>
            <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-200">Cantidad</th>
            <th class="px-4 py-2 text-right text-gray-700 dark:text-gray-200">Total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of venta.productos" class="hover:bg-gray-100 dark:hover:bg-gray-700">
            <td class="px-4 py-2 font-medium text-gray-800 dark:text-gray-200">{{ item.codigo }}</td>
            <td class="px-4 py-2 text-gray-600 dark:text-gray-300">{{ item.descripcion }}</td>
            <td class="px-4 py-2 text-right text-gray-600 dark:text-gray-300">{{ getValorVentaRedondeado(item.valor_unitario || 0.0) }}</td>
            <td class="px-4 py-2 text-center text-gray-600 dark:text-gray-300">{{ item.cantidad }}</td>
            <td class="px-4 py-2 text-right text-gray-600 dark:text-gray-300">{{ getValorVentaRedondeado(item.valor_venta || 0.0) }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Totales -->
    <div class="p-2 flex flex-col md:flex-row justify-end gap-6 text-gray-800 dark:text-gray-200">
      <div class="text-right space-y-1">
        <p>Subtotal: S/{{ getValorVentaRedondeado(venta.subtotal || 0.0) }}</p>
        <p>IGV: S/{{ getValorVentaRedondeado(venta.igv_total || 0.0) }}</p>
        <p class="font-bold text-lg border-t border-gray-300 dark:border-gray-600 pt-1">Total: S/{{ getValorVentaRedondeado(venta.total || 0.0) }}</p>
      </div>
    </div>

  </div>

  <!-- Acciones de Venta -->
  <div class="w-full md:w-72 flex-shrink-0 flex flex-col gap-4">
       <button tuiButton appearance="floating" iconStart="@tui.send-horizontal"
                tuiButtonVertical
                class=" text-white rounded-lg shadow transition">
              Hacer comprobante
            </button>
            <button tuiButton appearance="negative" iconStart="@tui.ban"
                tuiButtonVertical
                class="bg-red-600  text-white rounded-lg shadow transition">
                Eliminar Venta
            </button>
  </div>

</div>



